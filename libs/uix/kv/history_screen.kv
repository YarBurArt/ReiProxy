#:include libs/uix/widgets/rsec.kv
#:include libs/uix/widgets/hitem.kv
#:import HttpLexer pygments.lexers.HttpLexer

<HistoryScreen>
    BoxLayout:
        padding: [0, 0, 0, dp(60)]
        orientation: 'vertical'
        MDBoxLayout:
            orientation: 'horizontal'
            adaptive_height: True
            padding: dp(5)
            spacing: dp(8)
            MDLabel:
                text: "HTTP history"
                font_style: "Title"
                role: "medium"
                adaptive_height: True
            MDExtendedFabButton:
                fab_state: "expand"
                on_release: app.root.push("repeater", side="left") # TODO func with req id
                height: "35dp"
                MDExtendedFabButtonText:
                    text: "Repeat"
            MDExtendedFabButton:
                fab_state: "expand"
                on_release: app.root.push("repeater", side="left") # TODO req id
                height: "35dp"
                MDExtendedFabButtonText:
                    text: "Automate"
        
        MDBoxLayout:
            orientation: "horizontal"
            adaptive_height: True
            padding: [dp(10), dp(5)]
            spacing: dp(5)
            
            MDLabel:
                text: "#"
                size_hint_x: None
                width: dp(40)
                bold: True
            MDLabel:
                text: "Method"
                size_hint_x: None
                width: dp(70)
                bold: True
            MDLabel:
                text: "Host"
                size_hint_x: None
                width: dp(150)
                bold: True
            MDLabel:
                text: "URL"
                size_hint_x: 1
                bold: True
            MDLabel:
                text: "Status"
                size_hint_x: None
                width: dp(60)
                bold: True
            MDLabel:
                text: "Time"
                size_hint_x: None
                width: dp(70)
                bold: True
            MDLabel:
                text: "MIME"
                size_hint_x: None
                width: dp(100)
                bold: True

        ScrollView:
            do_scroll_x: False
            MDList:
                id: project_list
                spacing: 0

        BoxLayout:
            orientation: 'horizontal'
            padding: dp(8)
            spacing: dp(8)

            # Left Section: Request 
            RoundedSection:
                MDLabel:
                    text: "REQUEST"
                    size_hint_y: None
                    height: dp(20)
                CodeInput:
                    text: ""
                    style_name: 'monokai' 
                    background_color: 0,0,0,0
                    foreground_color: 1,1,1,1
                    font_name: "Roboto" 
                    lexer: HttpLexer()
                    readonly: True
                    id: req_h

            # Right Section: Response
            RoundedSection:
                bg_color: [0.12, 0.12, 0.12, 1]
                MDLabel:
                    text: "RESPONSE"
                    size_hint_y: None
                    height: dp(20)
                ScrollView:
                    CodeInput:
                        id: res_h
                        text: ""
                        readonly: True
                        lexer: HttpLexer()
                        style_name: 'monokai' 
                        background_color: 0,0,0,0
                        foreground_color: 1,1,1,1
                        size_hint_y: None
                        height: self.minimum_height